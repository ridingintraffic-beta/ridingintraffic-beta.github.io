<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>keybase gpg signing | what did I learn today</title><meta name=keywords content="tools"><meta name=description content="I am borrowing this from pstadler because it is really good https://github.com/pstadler/keybase-gpg-github/blob/master/README.md
Set up Keybase.io, GPG & Git to sign commits on GitHub This is a step-by-step guide on how to create a GPG key on keybase.io, adding it to a local GPG setup and use it with Git and GitHub.
Although this guide was written for macOS, most commands should work in other operating systems as well.
There&rsquo;s a video published by Timothy Miller explaining some parts of this guide."><meta name=author content="Mike Fettis"><link rel=canonical href=https://ridingintraffic-beta.github.io/posts/2020-11-17-keybase-gpg-signing/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.bc1149f4a72aa4858d3a9f71462f75e5884ffe8073ea9d6d5761d5663d651e20.css integrity="sha256-vBFJ9KcqpIWNOp9xRi915YhP/oBz6p1tV2HVZj1lHiA=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://ridingintraffic-beta.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://ridingintraffic-beta.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://ridingintraffic-beta.github.io/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://ridingintraffic-beta.github.io/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://ridingintraffic-beta.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-92674236-1","auto"),ga("send","pageview"))</script><meta property="og:title" content="keybase gpg signing"><meta property="og:description" content="I am borrowing this from pstadler because it is really good https://github.com/pstadler/keybase-gpg-github/blob/master/README.md
Set up Keybase.io, GPG & Git to sign commits on GitHub This is a step-by-step guide on how to create a GPG key on keybase.io, adding it to a local GPG setup and use it with Git and GitHub.
Although this guide was written for macOS, most commands should work in other operating systems as well.
There&rsquo;s a video published by Timothy Miller explaining some parts of this guide."><meta property="og:type" content="article"><meta property="og:url" content="https://ridingintraffic-beta.github.io/posts/2020-11-17-keybase-gpg-signing/"><meta property="og:image" content="https://ridingintraffic-beta.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-11-17T00:00:00-05:00"><meta property="article:modified_time" content="2020-11-17T00:00:00-05:00"><meta property="og:site_name" content="what did i learn today"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://ridingintraffic-beta.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="keybase gpg signing"><meta name=twitter:description content="I am borrowing this from pstadler because it is really good https://github.com/pstadler/keybase-gpg-github/blob/master/README.md
Set up Keybase.io, GPG & Git to sign commits on GitHub This is a step-by-step guide on how to create a GPG key on keybase.io, adding it to a local GPG setup and use it with Git and GitHub.
Although this guide was written for macOS, most commands should work in other operating systems as well.
There&rsquo;s a video published by Timothy Miller explaining some parts of this guide."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://ridingintraffic-beta.github.io/posts/"},{"@type":"ListItem","position":2,"name":"keybase gpg signing","item":"https://ridingintraffic-beta.github.io/posts/2020-11-17-keybase-gpg-signing/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"keybase gpg signing","name":"keybase gpg signing","description":"I am borrowing this from pstadler because it is really good https://github.com/pstadler/keybase-gpg-github/blob/master/README.md\nSet up Keybase.io, GPG \u0026amp; Git to sign commits on GitHub This is a step-by-step guide on how to create a GPG key on keybase.io, adding it to a local GPG setup and use it with Git and GitHub.\nAlthough this guide was written for macOS, most commands should work in other operating systems as well.\nThere\u0026rsquo;s a video published by Timothy Miller explaining some parts of this guide.","keywords":["tools"],"articleBody":"I am borrowing this from pstadler because it is really good https://github.com/pstadler/keybase-gpg-github/blob/master/README.md\nSet up Keybase.io, GPG \u0026 Git to sign commits on GitHub This is a step-by-step guide on how to create a GPG key on keybase.io, adding it to a local GPG setup and use it with Git and GitHub.\nAlthough this guide was written for macOS, most commands should work in other operating systems as well.\nThere’s a video published by Timothy Miller explaining some parts of this guide. Discussion on Hacker News.\nNote: If you don’t want to use Keybase.io, follow this guide instead. For manually transferring keys to different hosts, check out this answer on Stack Overflow.\nRequirements 1 2 $ brew install gpg $ brew cask install keybase You should already have an account with Keybase and be signed in locally using $ keybase login. In case you need to set up a new device first, follow the instructions provided by the keybase command during login.\nMake sure your local version of Git is at least 2.0 ($ git --version) to automatically sign all your commits. If that’s not the case, use Homebrew to install the latest Git version: $ brew install git.\nCreate a new GPG key on keybase.io 1 2 3 4 5 6 7 8 9 10 11 12 $ keybase pgp gen --multi # Enter your real name, which will be publicly visible in your new key: Patrick Stadler # Enter a public email address for your key: patrick.stadler@gmail.com # Enter another email address (or when done): # Push an encrypted copy of your new secret key to the Keybase.io server? [Y/n] Y # ▶ INFO PGP User ID: Patrick Stadler [primary] # ▶ INFO Generating primary key (4096 bits) # ▶ INFO Generating encryption subkey (4096 bits) # ▶ INFO Generated new PGP key: # ▶ INFO user: Patrick Stadler # ▶ INFO 4096-bit RSA key, ID CB86A866E870EE00, created 2016-04-06 # ▶ INFO Exported new key to the local GPG keychain Set up Git to sign all commits 1 2 3 4 5 6 7 8 9 $ gpg --list-secret-keys --keyid-format LONG # /Users/pstadler/.gnupg/secring.gpg # ---------------------------------- # sec 4096R/E870EE00 2016-04-06 [expires: 2032-04-02] # uid Patrick Stadler # ssb 4096R/F9E3E72E 2016-04-06 $ git config --global user.signingkey E870EE00 $ git config --global commit.gpgsign true Add public GPG key to GitHub 1 2 3 4 5 6 $ open https://github.com/settings/keys # Click \"New GPG key\" # We can then use `export` with the `-q` or query flag to match on our key (the first 16 characters should do..) $ keybase pgp export -q CB86A866E870EE00 | pbcopy # copy public key to clipboard # Paste key, save Import key to GPG on another host 1 2 3 4 5 6 7 8 9 10 $ keybase pgp export # ▶ WARNING Found several matches: # user: Patrick Stadler # 4096-bit RSA key, ID CB86A866E870EE00, created 2016-04-06 # user: keybase.io/ps # 4096-bit RSA key, ID 31DBBB1F6949DA68, created 2014-03-26 $ keybase pgp export -q CB86A866E870EE00 | gpg --import $ keybase pgp export -q CB86A866E870EE00 --secret | gpg --allow-secret-key-import --import Troubleshooting: gpg failed to sign the data If you cannot sign a commit after running through the above steps, and have an error like:\n1 2 3 $ git commit -m \"My commit\" # error: gpg failed to sign the data # fatal: failed to write commit object You can run echo \"test\" | gpg --clearsign to find the underlying issue.\nIf the above succeeds without error, then there is likely a configuration problem that is preventing git from selecting or using the secret key. Confirm that your gitconfig user.email matches the secret key that you are using for signing.\nOptional: Set as default GPG key 1 2 3 $ $EDITOR ~/.gnupg/gpg.conf # Add line: default-key E870EE00 Optional: Fix for Git UIs If you use a UI such as Git Tower or Github Desktop, you may need to configure git to point to the specific gpg executable:\n1 git config --global gpg.program $(which gpg) Optional: Disable TTY If you have problems with making autosigned commits from IDE or other software add no-tty config\n1 2 3 $ $EDITOR ~/.gnupg/gpg.conf # Add line: no-tty Optional: Setting up TTY Depending on your personal setup, you might need to define the tty for gpg whenever your passphrase is prompted. Otherwise, you might encounter an Inappropriate ioctl for device error.\n1 2 3 4 $ $EDITOR ~/.profile # or other file that is sourced every time # Paste these lines GPG_TTY=$(tty) export GPG_TTY Optional: In case you’re prompted to enter the password every time Some people found that this works out of the box w/o following these steps.\nMethod 1 - gpg-agent + pinentry-mac Install pinentry-mac:\n1 $ brew install pinentry-mac Set up the agent:\n1 2 3 $ $EDITOR ~/.gnupg/gpg-agent.conf # Paste this line: pinentry-program /usr/local/bin/pinentry-mac Now git commit -S, it will ask your password and you can save it to macOS keychain.\nMethod 2 - GPG Suite Some people find that pinentry installed with brew does not allow the password to be saved to macOS’s keychain.\nIf you do not see “Save in Keychain” after following Method 1, first uninstall the version of pinentry-mac installed with brew:\n1 $ brew uninstall pinentry-mac Now install the GPG Suite versions, available from gpgtools.org, or from brew by running:\n1 $ brew cask install gpg-suite Once installed, open Spotlight and search for “GPGPreferences”, or open system preferences and select “GPGPreferences”\nSelect the Default Key if it is not already selected, and ensure “Store in OS X Keychain” is checked:\nThe gpg-agent.conf is different from Method 1:\nSet up the agent:\n1 2 3 4 $ $EDITOR ~/.gnupg/gpg-agent.conf # GPG Suite should pre-populate with something similar to the following: default-cache-ttl 600 max-cache-ttl 7200 ","wordCount":"966","inLanguage":"en","datePublished":"2020-11-17T00:00:00-05:00","dateModified":"2020-11-17T00:00:00-05:00","author":{"@type":"Person","name":"Mike Fettis"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://ridingintraffic-beta.github.io/posts/2020-11-17-keybase-gpg-signing/"},"publisher":{"@type":"Organization","name":"what did I learn today","logo":{"@type":"ImageObject","url":"https://ridingintraffic-beta.github.io/%3Clink%20/%20abs%20url%3E"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://ridingintraffic-beta.github.io/ accesskey=h title="ridingintraffic (Alt + H)"><img src=https://ridingintraffic-beta.github.io/apple-touch-icon.png alt aria-label=logo height=35>ridingintraffic</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://ridingintraffic-beta.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=https://ridingintraffic-beta.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://ridingintraffic.github.io title=traffic><span>traffic</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://ridingintraffic-beta.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://ridingintraffic-beta.github.io/posts/>Posts</a></div><h1 class=post-title>keybase gpg signing</h1><div class=post-meta><span title='2020-11-17 00:00:00 -0500 -0500'>2020-11-17</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;966 words&nbsp;·&nbsp;Mike Fettis&nbsp;|&nbsp;<a href=https://github.com/ridingintraffic-beta/ridingintraffic-beta.github.io/blob/main/content/posts/2020-11-17-keybase-gpg-signing.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=post-content><h1 id=i-am-borrowing-this-from-pstadler-because-it-is-really-good>I am borrowing this from pstadler because it is really good<a hidden class=anchor aria-hidden=true href=#i-am-borrowing-this-from-pstadler-because-it-is-really-good>#</a></h1><p><a href=https://github.com/pstadler/keybase-gpg-github/blob/master/README.md>https://github.com/pstadler/keybase-gpg-github/blob/master/README.md</a></p><h1 id=set-up-keybaseio-gpg--git-to-sign-commits-on-github>Set up Keybase.io, GPG & Git to sign commits on GitHub<a hidden class=anchor aria-hidden=true href=#set-up-keybaseio-gpg--git-to-sign-commits-on-github>#</a></h1><p>This is a step-by-step guide on how to create a GPG key on <a href=https://keybase.io>keybase.io</a>, adding it to a local GPG setup and use it with Git and GitHub.</p><p>Although this guide was written for macOS, most commands should work in other operating systems as well.</p><p>There&rsquo;s a <a href="https://www.youtube.com/watch?v=4V-7KnhcrbY">video</a> published by <a href=https://github.com/tjacobdesign>Timothy Miller</a> explaining some parts of this guide. <a href="https://news.ycombinator.com/item?id=12289481">Discussion</a> on Hacker News.</p><blockquote><p><strong>Note</strong>: If you <strong>don&rsquo;t</strong> want to use Keybase.io, follow <a href=https://help.github.com/articles/generating-a-new-gpg-key/>this guide</a> instead.
For manually transferring keys to different hosts, check out this <a href=https://stackoverflow.com/a/3176373/571227>answer on Stack Overflow</a>.</p></blockquote><h2 id=requirements>Requirements<a hidden class=anchor aria-hidden=true href=#requirements>#</a></h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ brew install gpg
</span></span><span class=line><span class=cl>$ brew cask install keybase
</span></span></code></pre></td></tr></table></div></div><p>You should already have an account with Keybase and be signed in locally using <code>$ keybase login</code>. In case you need to set up a new device first, follow the instructions provided by the keybase command during login.</p><p>Make sure your local version of Git is at least 2.0 (<code>$ git --version</code>) to automatically sign all your commits. If that&rsquo;s not the case, use Homebrew to install the latest Git version: <code>$ brew install git</code>.</p><h2 id=create-a-new-gpg-key-on-keybaseio>Create a new GPG key on keybase.io<a hidden class=anchor aria-hidden=true href=#create-a-new-gpg-key-on-keybaseio>#</a></h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ keybase pgp gen --multi
</span></span><span class=line><span class=cl><span class=c1># Enter your real name, which will be publicly visible in your new key: Patrick Stadler</span>
</span></span><span class=line><span class=cl><span class=c1># Enter a public email address for your key: patrick.stadler@gmail.com</span>
</span></span><span class=line><span class=cl><span class=c1># Enter another email address (or &lt;enter&gt; when done):</span>
</span></span><span class=line><span class=cl><span class=c1># Push an encrypted copy of your new secret key to the Keybase.io server? [Y/n] Y</span>
</span></span><span class=line><span class=cl><span class=c1># ▶ INFO PGP User ID: Patrick Stadler &lt;patrick.stadler@gmail.com&gt; [primary]</span>
</span></span><span class=line><span class=cl><span class=c1># ▶ INFO Generating primary key (4096 bits)</span>
</span></span><span class=line><span class=cl><span class=c1># ▶ INFO Generating encryption subkey (4096 bits)</span>
</span></span><span class=line><span class=cl><span class=c1># ▶ INFO Generated new PGP key:</span>
</span></span><span class=line><span class=cl><span class=c1># ▶ INFO   user: Patrick Stadler &lt;patrick.stadler@gmail.com&gt;</span>
</span></span><span class=line><span class=cl><span class=c1># ▶ INFO   4096-bit RSA key, ID CB86A866E870EE00, created 2016-04-06</span>
</span></span><span class=line><span class=cl><span class=c1># ▶ INFO Exported new key to the local GPG keychain</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=set-up-git-to-sign-all-commits>Set up Git to sign all commits<a hidden class=anchor aria-hidden=true href=#set-up-git-to-sign-all-commits>#</a></h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ gpg --list-secret-keys --keyid-format LONG
</span></span><span class=line><span class=cl><span class=c1># /Users/pstadler/.gnupg/secring.gpg</span>
</span></span><span class=line><span class=cl><span class=c1># ----------------------------------</span>
</span></span><span class=line><span class=cl><span class=c1># sec   4096R/E870EE00 2016-04-06 [expires: 2032-04-02]</span>
</span></span><span class=line><span class=cl><span class=c1># uid                  Patrick Stadler &lt;patrick.stadler@gmail.com&gt;</span>
</span></span><span class=line><span class=cl><span class=c1># ssb   4096R/F9E3E72E 2016-04-06</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ git config --global user.signingkey E870EE00
</span></span><span class=line><span class=cl>$ git config --global commit.gpgsign <span class=nb>true</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=add-public-gpg-key-to-github>Add public GPG key to GitHub<a hidden class=anchor aria-hidden=true href=#add-public-gpg-key-to-github>#</a></h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ open https://github.com/settings/keys
</span></span><span class=line><span class=cl><span class=c1># Click &#34;New GPG key&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># We can then use `export` with the `-q` or query flag to match on our key (the first 16 characters should do..)</span>
</span></span><span class=line><span class=cl>$ keybase pgp <span class=nb>export</span> -q CB86A866E870EE00 <span class=p>|</span> pbcopy <span class=c1># copy public key to clipboard</span>
</span></span><span class=line><span class=cl><span class=c1># Paste key, save</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=import-key-to-gpg-on-another-host>Import key to GPG on another host<a hidden class=anchor aria-hidden=true href=#import-key-to-gpg-on-another-host>#</a></h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ keybase pgp <span class=nb>export</span>
</span></span><span class=line><span class=cl><span class=c1># ▶ WARNING Found several matches:</span>
</span></span><span class=line><span class=cl><span class=c1># user: Patrick Stadler &lt;patrick.stadler@gmail.com&gt;</span>
</span></span><span class=line><span class=cl><span class=c1># 4096-bit RSA key, ID CB86A866E870EE00, created 2016-04-06</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># user: keybase.io/ps &lt;ps@keybase.io&gt;</span>
</span></span><span class=line><span class=cl><span class=c1># 4096-bit RSA key, ID 31DBBB1F6949DA68, created 2014-03-26</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>$ keybase pgp <span class=nb>export</span> -q CB86A866E870EE00 <span class=p>|</span> gpg --import
</span></span><span class=line><span class=cl>$ keybase pgp <span class=nb>export</span> -q CB86A866E870EE00 --secret <span class=p>|</span> gpg --allow-secret-key-import --import
</span></span></code></pre></td></tr></table></div></div><h2 id=troubleshooting-gpg-failed-to-sign-the-data>Troubleshooting: <code>gpg failed to sign the data</code><a hidden class=anchor aria-hidden=true href=#troubleshooting-gpg-failed-to-sign-the-data>#</a></h2><p>If you cannot sign a commit after running through the above steps, and have an error like:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ git commit -m <span class=s2>&#34;My commit&#34;</span>
</span></span><span class=line><span class=cl><span class=c1># error: gpg failed to sign the data</span>
</span></span><span class=line><span class=cl><span class=c1># fatal: failed to write commit object</span>
</span></span></code></pre></td></tr></table></div></div><p>You can run <code>echo "test" | gpg --clearsign</code> to find the underlying issue.</p><p>If the above succeeds without error, then there is likely a configuration problem that is preventing git from selecting or using the secret key. Confirm that your gitconfig <code>user.email</code> matches the secret key that you are using for signing.</p><h2 id=optional-set-as-default-gpg-key>Optional: Set as default GPG key<a hidden class=anchor aria-hidden=true href=#optional-set-as-default-gpg-key>#</a></h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ <span class=nv>$EDITOR</span> ~/.gnupg/gpg.conf
</span></span><span class=line><span class=cl><span class=c1># Add line:</span>
</span></span><span class=line><span class=cl>default-key E870EE00
</span></span></code></pre></td></tr></table></div></div><h2 id=optional-fix-for-git-uis>Optional: Fix for Git UIs<a hidden class=anchor aria-hidden=true href=#optional-fix-for-git-uis>#</a></h2><p>If you use a UI such as Git Tower or Github Desktop, you may need to configure git to point to the specific gpg executable:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>git config --global gpg.program <span class=k>$(</span>which gpg<span class=k>)</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=optional-disable-tty>Optional: Disable TTY<a hidden class=anchor aria-hidden=true href=#optional-disable-tty>#</a></h2><p>If you have problems with making autosigned commits from IDE or other software add no-tty config</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ <span class=nv>$EDITOR</span> ~/.gnupg/gpg.conf
</span></span><span class=line><span class=cl><span class=c1># Add line:</span>
</span></span><span class=line><span class=cl>no-tty
</span></span></code></pre></td></tr></table></div></div><h2 id=optional-setting-up-tty>Optional: Setting up TTY<a hidden class=anchor aria-hidden=true href=#optional-setting-up-tty>#</a></h2><p>Depending on your personal setup, you might need to define the tty for gpg
whenever your passphrase is prompted. Otherwise, you might encounter an <code>Inappropriate ioctl for device</code> error.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ <span class=nv>$EDITOR</span> ~/.profile <span class=c1># or other file that is sourced every time</span>
</span></span><span class=line><span class=cl><span class=c1># Paste these lines</span>
</span></span><span class=line><span class=cl><span class=nv>GPG_TTY</span><span class=o>=</span><span class=k>$(</span>tty<span class=k>)</span>
</span></span><span class=line><span class=cl><span class=nb>export</span> GPG_TTY
</span></span></code></pre></td></tr></table></div></div><h2 id=optional-in-case-youre-prompted-to-enter-the-password-every-time>Optional: In case you&rsquo;re prompted to enter the password every time<a hidden class=anchor aria-hidden=true href=#optional-in-case-youre-prompted-to-enter-the-password-every-time>#</a></h2><blockquote><p>Some people found that this works out of the box w/o following these steps.</p></blockquote><h3 id=method-1---gpg-agent--pinentry-mac>Method 1 - gpg-agent + pinentry-mac<a hidden class=anchor aria-hidden=true href=#method-1---gpg-agent--pinentry-mac>#</a></h3><p>Install pinentry-mac:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ brew install pinentry-mac
</span></span></code></pre></td></tr></table></div></div><p>Set up the agent:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ <span class=nv>$EDITOR</span> ~/.gnupg/gpg-agent.conf
</span></span><span class=line><span class=cl><span class=c1># Paste this line:</span>
</span></span><span class=line><span class=cl>pinentry-program /usr/local/bin/pinentry-mac
</span></span></code></pre></td></tr></table></div></div><p>Now <code>git commit -S</code>, it will ask your password and you can save it to macOS
keychain.</p><p><img loading=lazy src=assets/images/pinentry.png alt=pinentry></p><h3 id=method-2---gpg-suite>Method 2 - GPG Suite<a hidden class=anchor aria-hidden=true href=#method-2---gpg-suite>#</a></h3><p>Some people find that pinentry installed with brew does not allow the password to be saved to macOS&rsquo;s keychain.</p><p>If you do not see &ldquo;Save in Keychain&rdquo; after following Method 1, first uninstall the version of pinentry-mac installed with brew:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ brew uninstall pinentry-mac
</span></span></code></pre></td></tr></table></div></div><p>Now install the GPG Suite versions, available from <a href=https://gpgtools.org/#gpgsuite>gpgtools.org</a>, or from brew by running:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ brew cask install gpg-suite
</span></span></code></pre></td></tr></table></div></div><p>Once installed, open Spotlight and search for &ldquo;GPGPreferences&rdquo;, or open system preferences and select &ldquo;GPGPreferences&rdquo;</p><p>Select the Default Key if it is not already selected, and ensure &ldquo;Store in OS X Keychain&rdquo; is checked:</p><p><img loading=lazy src=assets/images/gpg-preferences.png alt="gpg preferences"></p><p>The <code>gpg-agent.conf</code> is different from Method 1:</p><p>Set up the agent:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ <span class=nv>$EDITOR</span> ~/.gnupg/gpg-agent.conf
</span></span><span class=line><span class=cl><span class=c1># GPG Suite should pre-populate with something similar to the following:</span>
</span></span><span class=line><span class=cl>default-cache-ttl <span class=m>600</span>
</span></span><span class=line><span class=cl>max-cache-ttl <span class=m>7200</span>
</span></span></code></pre></td></tr></table></div></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://ridingintraffic-beta.github.io/tags/tools/>tools</a></li></ul><nav class=paginav><a class=prev href=https://ridingintraffic-beta.github.io/posts/2021-01-19-vim-jq/><span class=title>« Prev</span><br><span>vim-jq</span></a>
<a class=next href=https://ridingintraffic-beta.github.io/posts/2020-11-12-bfg-delete-files/><span class=title>Next »</span><br><span>bfg -delete</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share keybase gpg signing on twitter" href="https://twitter.com/intent/tweet/?text=keybase%20gpg%20signing&url=https%3a%2f%2fridingintraffic-beta.github.io%2fposts%2f2020-11-17-keybase-gpg-signing%2f&hashtags=tools"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share keybase gpg signing on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fridingintraffic-beta.github.io%2fposts%2f2020-11-17-keybase-gpg-signing%2f&title=keybase%20gpg%20signing&summary=keybase%20gpg%20signing&source=https%3a%2f%2fridingintraffic-beta.github.io%2fposts%2f2020-11-17-keybase-gpg-signing%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share keybase gpg signing on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fridingintraffic-beta.github.io%2fposts%2f2020-11-17-keybase-gpg-signing%2f&title=keybase%20gpg%20signing"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share keybase gpg signing on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fridingintraffic-beta.github.io%2fposts%2f2020-11-17-keybase-gpg-signing%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share keybase gpg signing on whatsapp" href="https://api.whatsapp.com/send?text=keybase%20gpg%20signing%20-%20https%3a%2f%2fridingintraffic-beta.github.io%2fposts%2f2020-11-17-keybase-gpg-signing%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share keybase gpg signing on telegram" href="https://telegram.me/share/url?text=keybase%20gpg%20signing&url=https%3a%2f%2fridingintraffic-beta.github.io%2fposts%2f2020-11-17-keybase-gpg-signing%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://ridingintraffic-beta.github.io/>what did I learn today</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>